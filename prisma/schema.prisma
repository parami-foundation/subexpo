datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model ChainBlock {
  blockNum        Int              @id
  blockAt         Int
  blockHash       String           @unique
  parentHash      String
  stateRoot       String
  extrinsicsRoot  String
  logs            ChainLog[]
  extrinsics      ChainExtrinsic[]
  extrinsicsCount Int
  events          ChainEvent[]
  eventsCount     Int
  specVersion     Int
  validator       String
  finalized       Boolean          @default(false)
}

model ChainEvent {
  eventId        String          @id
  blockNum       Int
  blockAt        Int
  extrinsicId    String
  eventIdx       Int
  section        String
  method         String
  data           Json
  ChainBlock     ChainBlock?     @relation(fields: [blockNum], references: [blockNum])
  ChainExtrinsic ChainExtrinsic? @relation(fields: [extrinsicId], references: [extrinsicId])
}

model ChainExtrinsic {
  extrinsicId     String       @id
  blockNum        Int
  blockAt         Int
  method          String
  section         String
  args            Json
  events          ChainEvent[]
  accountId       String?
  signature       String?
  nonce           Int
  extrinsicHash   String       @unique
  isSigned        Boolean
  success         Boolean
  fee             BigInt
  tip             BigInt
  versionInfo     Int
  extrinsicLength Int
  ChainBlock      ChainBlock?  @relation(fields: [blockNum], references: [blockNum])
}

model ChainLog {
  logId      String      @id
  blockNum   Int
  logType    String
  data       Json
  finalized  Boolean     @default(false)
  ChainBlock ChainBlock? @relation(fields: [blockNum], references: [blockNum])
}

model ChainVersion {
  specVersion   Int  @id
  modules       Json
  mergedModules Json
  rawData       Json
}
