datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model ChainBlock {
  blockNum        Int              @id
  blockAt         Int
  blockHash       String           @unique
  parentHash      String
  stateRoot       String
  extrinsicsRoot  String
  logs            ChainLog[]
  extrinsics      ChainExtrinsic[]
  extrinsicsCount Int
  events          ChainEvent[]
  eventCount      Int
  specVersion     Int
  validator       String
  finalized       Boolean          @default(false)
}

model ChainEvent {
  eventIndex       String          @id
  blockNum         Int             
  blockAt          Int
  blockHash        String
  extrinsicIdx     Int
  section          String
  method           String
  data             Json
  extrinsicHash    String
  eventIdx         Int
  ChainBlock       ChainBlock?     @relation(fields: [blockNum], references: [blockNum])
  ChainExtrinsic   ChainExtrinsic? @relation(fields: [extrinsicHash], references: [extrinsicHash])
}

model ChainExtrinsic {
  extrinsicIndex  String       @id
  blockNum        Int
  blockAt         Int
  blockHash       String
  extrinsicLength Int
  versionInfo     Int
  method          String
  section         String
  args            Json
  events          ChainEvent[]
  accountId       String?
  signature       String?
  nonce           Int
  extrinsicHash   String       @unique
  isSigned        Boolean
  success         Boolean
  fee             BigInt
  tip             BigInt
  ChainBlock      ChainBlock?  @relation(fields: [blockNum], references: [blockNum])
}

model ChainLog {
  logIndex     String          @id
  blockNum     Int
  logType      String
  data         Json
  finalized    Boolean     @default(false)
  ChainBlock   ChainBlock? @relation(fields: [blockNum], references: [blockNum])
}

model RuntimeVersion {
  id          Int    @id @default(autoincrement())
  name        String
  specVersion Int
  modules     String @db.Text
  rawData     String @db.MediumText
}
